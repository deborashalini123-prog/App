// Connect to your backend Socket.IO server
const socket = io("https://application-6169.onrender.com"); // your Render backend URL

const chatBox = document.getElementById("chat-box");
const msgInput = document.getElementById("msg");
const sendBtn = document.getElementById("sendBtn");

// Load old messages when connected
socket.on("loadMessages", (messages) => {
  chatBox.innerHTML = ""; // clear old
  messages.forEach((msg) => displayMessage(msg.text, msg.sender === "You"));
});

// Send new message
sendBtn.addEventListener("click", () => {
  const message = msgInput.value.trim();
  if (message === "") return;

  const data = { text: message, sender: "You" };

  // Send to backend
  socket.emit("sendMessage", data);

  // Show instantly
  displayMessage(message, true);
  msgInput.value = "";
});

// Receive message from backend
socket.on("receiveMessage", (data) => {
  if (data.sender !== "You") displayMessage(data.text, false);
});

// Display message in chat
function displayMessage(message, isOwn) {
  const div = document.createElement("div");
  div.classList.add("message");
  if (isOwn) div.classList.add("my-message");
  div.textContent = message;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}
