// Connect to backend
const socket = io("https://application-6169.onrender.com"); // your Render backend URL

// Get elements
const chatBox = document.getElementById("chat-box");
const msgInput = document.getElementById("msg");
const sendBtn = document.getElementById("sendBtn");

// Load old messages
socket.on("loadMessages", (messages) => {
  chatBox.innerHTML = "";
  messages.forEach((msg) => displayMessage(msg.text, msg.sender === "You"));
});

// Send new message
sendBtn.addEventListener("click", () => {
  const message = msgInput.value.trim();
  if (message === "") return;

  const data = { text: message, sender: "You" };
  socket.emit("sendMessage", data);
  displayMessage(message, true);
  msgInput.value = "";
});

// Receive messages from backend
socket.on("receiveMessage", (data) => {
  if (data.sender !== "You") displayMessage(data.text, false);
});

// Display message in chat box
function displayMessage(message, isOwn) {
  const div = document.createElement("div");
  div.classList.add("message");
  div.classList.add(isOwn ? "my-message" : "other-message");
  div.textContent = message;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}
